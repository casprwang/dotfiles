{"version":3,"sources":["../../../src/elements/types/Program.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAOA;;;;AACA;;;;;;IAEqB,O;;;AACjB,qBAAY,UAAZ,EAAoC;AAAA;;AAAA,qHAC1B,SAD0B,EACf,UADe;;AAGhC,cAAK,UAAL,GAAkB,IAAlB;AACA,cAAK,SAAL,GAAiB,wBAAjB;AACA,cAAK,SAAL,CAAe,WAAf,CAA2B,UAA3B;AACA,cAAK,eAAL,GAAuB,EAAvB;AANgC;AAOnC;;;;uCAQc,O,EAAsC;AACjD,iBAAK,OAAL,GAAe,OAAf;AACH;;;wCAEe,Q,EAAyB;AACrC,gBAAI,SAAS,OAAT,CAAiB,UAAjB,CAAJ,EAAkC;AAC9B,yBAAS,SAAT,CAAmB,UAAnB;AACH;;AAED,qBAAS,WAAT;;AAEA,gBAAI,aAAa,EAAjB;AACA,mBAAO,SAAS,MAAT,CAAgB,WAAhB,CAAP,EAAqC;AACjC,2BAAW,IAAX,CAAgB,SAAS,QAAT,EAAhB;AACA,yBAAS,WAAT;AACH;;AAED,gBAAI,OAAO,EAAX;AACA,mBAAO,SAAS,WAAT,EAAP,EAA+B;AAC3B,qBAAK,IAAL,CAAU,SAAS,aAAT,EAAV;AACA,yBAAS,WAAT;AACH;;AAED,qBAAS,SAAT,CAAmB,KAAnB;AACA,qBAAS,SAAT;;AAEA,iBAAK,IAAL,GAAY,IAAZ;AACA,iBAAK,UAAL,GAAkB,UAAlB;AACH;;;;;;;;;;;0CAQiB,I,EAA2B;AACzC,mBAAO,KAAK,SAAL,CAAe,iBAAf,CAAiC,IAAjC,CAAP;AACH;;;;;;;;;;;2CAQkB,I,EAA4B;AAC3C,mBAAO,KAAK,SAAL,CAAe,kBAAf,CAAkC,IAAlC,CAAP;AACH;;;8CAEqB,Q,EAA0B;AAC5C,iBAAK,SAAL,CAAe,WAAf,CAA2B,QAA3B;AACA,iBAAK,KAAL,CAAW,cAAX,EAA2B,QAA3B;AACH;;;mDAE0B,Q,EAA0B;AACjD,iBAAK,SAAL,CAAe,cAAf,CAA8B,QAA9B;AACA,iBAAK,KAAL,CAAW,iBAAX,EAA8B,QAA9B;AACH;;;2BAEE,S,EAAmB,Q,EAAoB;AACtC,gBAAI,KAAK,eAAL,CAAqB,SAArB,CAAJ,EAAqC;AACjC,qBAAK,eAAL,CAAqB,SAArB,EAAgC,IAAhC,CAAqC,QAArC;AACH,aAFD,MAEO;AACH,qBAAK,eAAL,CAAqB,SAArB,IAAkC,CAAC,QAAD,CAAlC;AACH;AACJ;;;4BAEG,S,EAAmB,Q,EAAoB;AACvC,gBAAI,KAAK,eAAL,CAAqB,SAArB,CAAJ,EAAqC;AACjC,qBAAK,eAAL,CAAqB,SAArB,IAAkC,KAAK,eAAL,CAAqB,SAArB,EAAgC,MAAhC,CAAuC,UAAC,OAAD,EAAa;AAClF,2BAAO,aAAa,OAApB;AACH,iBAFiC,CAAlC;AAGH;AACJ;;;8BAEK,S,EAAmB,I,EAAW;AAChC,gBAAI,WAAW,KAAK,eAAL,CAAqB,SAArB,CAAf;AACA,gBAAI,QAAJ,EAAc;AACV,qBAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,SAAS,MAA7B,EAAqC,GAArC,EAA0C;AACtC,6BAAS,CAAT,EAAY,IAAZ;AACH;AACJ;AACJ;;;;;kBAnGgB,O;AAoGpB","file":"Program.js","sourcesContent":["/* @flow */\n\nimport type Token from '../Token';\nimport type Node from '../Node';\nimport type Element from '../Element';\nimport type ElementAssert from '../ElementAssert';\nimport type BasePlugin from '../../plugins/BasePlugin';\nimport Statement from '../Statement';\nimport Traverse from '../../Traverse';\n\nexport default class Program extends Statement {\n    constructor(childNodes: Array<any>) {\n        super('Program', childNodes);\n\n        this._isProgram = true;\n        this._traverse = new Traverse();\n        this._traverse.addElements(childNodes);\n        this._eventListeners = {};\n    }\n\n    _eventListeners: {[key: string]: Function[]};\n    _traverse: Traverse;\n    _body: Array<any>;\n    _isProgram: boolean;\n    plugins: {[key: string]: BasePlugin};\n\n    _acceptPlugins(plugins: {[key: string]: BasePlugin}) {\n        this.plugins = plugins;\n    }\n\n    _acceptChildren(children: ElementAssert) {\n        if (children.isToken('Hashbang')) {\n            children.passToken('Hashbang');\n        }\n\n        children.skipNonCode();\n\n        let directives = [];\n        while (children.isNode('Directive')) {\n            directives.push(children.passNode());\n            children.skipNonCode();\n        }\n\n        let body = [];\n        while (children.isStatement()) {\n            body.push(children.passStatement());\n            children.skipNonCode();\n        }\n\n        children.passToken('EOF');\n        children.assertEnd();\n\n        this.body = body;\n        this.directives = directives;\n    }\n\n    /**\n     * Returns node list with specified type from the tree.\n     *\n     * @param {String} type\n     * @returns {Node[]}\n     */\n    selectNodesByType(type: string): Array<Node> {\n        return this._traverse.selectNodesByType(type);\n    }\n\n    /**\n     * Returns tokens list with specified type from the tree.\n     *\n     * @param {String} type\n     * @returns {Token[]}\n     */\n    selectTokensByType(type: string): Array<Token> {\n        return this._traverse.selectTokensByType(type);\n    }\n\n    _addElementsToProgram(elements: Array<Element>) {\n        this._traverse.addElements(elements);\n        this._emit('elements-add', elements);\n    }\n\n    _removeElementsFromProgram(elements: Array<Element>) {\n        this._traverse.removeElements(elements);\n        this._emit('elements-remove', elements);\n    }\n\n    on(eventName: string, callback: Function) {\n        if (this._eventListeners[eventName]) {\n            this._eventListeners[eventName].push(callback);\n        } else {\n            this._eventListeners[eventName] = [callback];\n        }\n    }\n\n    off(eventName: string, callback: Function) {\n        if (this._eventListeners[eventName]) {\n            this._eventListeners[eventName] = this._eventListeners[eventName].filter((handler) => {\n                return callback !== handler;\n            });\n        }\n    }\n\n    _emit(eventName: string, data: any) {\n        var handlers = this._eventListeners[eventName];\n        if (handlers) {\n            for (let i = 0; i < handlers.length; i++) {\n                handlers[i](data);\n            }\n        }\n    }\n};\n"]}